\documentclass{article}

\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{graphicx}
\usepackage{gensymb}
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}

\graphicspath{{./images/}}

\usetikzlibrary{automata,positioning}

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}

\pagestyle{fancy}
\lhead{\hmwkAuthorName}
\chead{\hmwkClass\ \hmwkTitle}
\rhead{\firstxmark}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{}{Problem {#1} continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Problem {#1} (continued)}{Problem {#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{Problem {#1} (continued)}{Problem {#1} continued on next page\ldots}\nobreak{}
    % \stepcounter{#1}
    \nobreak\extramarks{Problem {#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}

\newcommand{\problemNumber}{0.0}

\newenvironment{homeworkProblem}[1][-1]{
    \renewcommand{\problemNumber}{{#1}}
    \section{Problem \problemNumber}
    \setcounter{partCounter}{1}
    \enterProblemHeader{\problemNumber}
}{
    \exitProblemHeader{\problemNumber}
}

%
% Homework Details
%   - Title
%   - Class
%   - Author
%

\newcommand{\hmwkTitle}{Homework\ \#3}
\newcommand{\hmwkClass}{RBE 500}
\newcommand{\hmwkAuthorName}{\textbf{Arjan Gupta}}

%
% Title Page
%

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass\ \hmwkTitle}}\\
    \vspace{3in}
}

\author{\hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}

\begin{document}

\maketitle

\nobreak\extramarks{Problem 4.2}{}\nobreak{}

\pagebreak

\begin{homeworkProblem}[4.2]
    Verify Equation (4.7) by direct calculation.

    \[
        S(a)p = a \times p \tag{4.7}
    \]

    \subsection{Solution}

    Suppose the vectors $a$ and $p$ are given as

    \[
        a =
            \begin{bmatrix}
                a_1\\
                a_2\\
                a_3
            \end{bmatrix},
        p =
            \begin{bmatrix}
                p_1\\
                p_2\\
                p_3
            \end{bmatrix}
    \]

    By the definition of the cross-product, we know
    \begin{align}
        a \times p =
        \begin{bmatrix}
            a_2p_3 - a_3p_2\\
            a_3p_1 - a_1p_3\\
            a_1p_2 - a_2p_1
        \end{bmatrix}
    \end{align}

    Also, by the definition of skew-symmetric matrices, we know the form of $S(a)$, where $a$ is the vector we have already defined,
    \[
        S(a) =
        \begin{bmatrix}
            0 & -a_z & a_y\\
            a_z & 0 & -a_x\\
            -a_y & a_x & 0\\
        \end{bmatrix}
    \]
    Hence, by normal matrix multiplication,
    \[
        S(a) p =
        \begin{bmatrix}
            0 - a_3p_2 + a_2p_3\\
            a_3p_1 + 0 -a_1p_3\\
            -a_2p_1 + a_1p_2 + 0
        \end{bmatrix}
        =
        \begin{bmatrix}
            a_2p_3 - a_3p_2\\
            a_3p_1 - a_1p_3\\
            a_1p_2 - a_2p_1
        \end{bmatrix}
    \]

    Which is the same as (1). Therefore, Equation (4.7) is proved.
\end{homeworkProblem}

\nobreak\extramarks{Problem 4.3}{}\nobreak{}

\pagebreak

\newcommand\norm[1]{\lVert#1\rVert}

\begin{homeworkProblem}[4.3]
    Prove the assertion given in Equation (4.9) that \(R (a \times b) = Ra \times Rb \) for \(R \in SO(3)\).

    \vspace{0.1in}
    \subsection{Solution}
    Let \(v = R (a \times b)\), and \(u = Ra \times Rb \). If $v$ and $u$ are the to be proved as the same vector, then
    it must be shown that they have the exact same magnitude and direction. Let us consider magnitude and direction of
    $v$ and $u$ separately.

    \subsubsection{Magnitude}

    Since \(R \in SO(3)\), \(\det{R} = 1\), which means that the linear transformation $R$ does not change the length (norm) of
    any vector that it transforms. Hence we can say

    \begin{align}        
        \norm{R(a \times b)} &= \norm{a \times b} \tag{1}\\
        \norm{Ra} &= \norm{a}\\
        \norm{Rb} &= \norm{b}
    \end{align}

    And by the definition of cross product, we know that
    \[
        \norm{a \times b} = \norm{a}\norm{b}\sin\theta
    \]
    Using Equation (1) here, we have
    \begin{align}
        \norm{R(a \times b)} = \norm{a}\norm{b}\sin\theta
    \end{align}

    \subsubsection{Direction}
\end{homeworkProblem}

\end{document}